/*!
 * vue-authenticate v1.3.4
 * https://github.com/dgrubelic/vue-authenticate
 * Released under the MIT License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueAuthenticate=e()}(this,function(){"use strict";function t(t){return t.replace(/([\:\-\_]+(.))/g,function(t,e,o,i){return i?o.toUpperCase():o})}function e(t){return void 0===t}function o(t){return null!==t&&"object"==typeof t}function i(t){return"string"==typeof t}function n(t){return"function"==typeof t}function r(){return navigator.userAgent.match(/iphone|ipod|ipad/i)&&!navigator.userAgent.match(/safari/i)}function a(){return!!navigator.userAgent.match(/instagram/i)||!!navigator.userAgent.match(/fban/i)||!!navigator.userAgent.match(/fbav/i)}function s(){return!!navigator.userAgent.match(/PLAYR\.gg/)}function p(){return r()&&(!!navigator.userAgent.match(/instagram/i)||!!navigator.userAgent.match(/fban/i))}function u(){return!!window.frameElement}function c(t,e){return null==t||null==e?t:(Object.keys(e).forEach(function(o){"[object Object]"==Object.prototype.toString.call(e[o])?"[object Object]"!=Object.prototype.toString.call(t[o])?t[o]=e[o]:t[o]=c(t[o],e[o]):t[o]=e[o]}),t)}function h(t,e){if(/^(?:[a-z]+:)?\/\//i.test(e))return e;var o=[t,e].join("/");return function(t){return t.replace(/[\/]+/g,"/").replace(/\/\?/g,"?").replace(/\/\#/g,"#").replace(/\:\//g,"://")}(o)}function l(t){var e="https:"===t.protocol;return t.protocol+"//"+t.hostname+":"+(t.port||(e?"443":"80"))+(/^\//.test(t.pathname)?t.pathname:"/"+t.pathname)}function d(t){var e,o,i={};return(t||"").split("&").forEach(function(t){t&&(o=t.split("="),e=decodeURIComponent(o[0]),i[e]=!o[1]||decodeURIComponent(o[1]))}),i}function f(t){var e;if("undefined"!=typeof module&&module.exports)try{e=require("buffer").Buffer}catch(t){}var o=String.fromCharCode,i=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),n=function(t){switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),i=e-65536;return o(55296+(i>>>10))+o(56320+(1023&i));case 3:return o((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return o((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},r=function(t){return t.replace(i,n)};return(e?function(t){return(t.constructor===e.constructor?t:new e(t,"base64")).toString()}:function(t){return r(atob(t))})(String(t).replace(/[-_]/g,function(t){return"-"===t?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))}function g(t){if(0===t.length)return{};var e={},o=new RegExp("\\s*;\\s*");return t.split(o).forEach(function(t){var o=t.split("="),i=o[0],n=o[1],r=decodeURIComponent(i),a=decodeURIComponent(n);e[r]=a}),e}function m(t){var e=t.path,o=t.domain,i=t.expires,n=t.secure,r=t.sameSite;return[void 0===e||null===e?"":";path="+e,void 0===o||null===o?"":";domain="+o,void 0===i||null===i?"":";expires="+i.toUTCString(),void 0===n||null===n||!1===n?"":";secure",void 0===r||null===r?"":";samesite="+r].join("")}function v(t,e,o){return[encodeURIComponent(t),"=",encodeURIComponent(e),m(o)].join("")}function w(){}function y(t,e){return function(){t.apply(e,arguments)}}function b(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],I(t,this)}function _(t,e){for(;3===t._state;)t=t._value;if(0===t._state)return void t._deferreds.push(e);t._handled=!0,b._immediateFn(function(){var o=1===t._state?e.onFulfilled:e.onRejected;if(null===o)return void(1===t._state?C:U)(e.promise,t._value);var i;try{i=o(t._value)}catch(t){return void U(e.promise,t)}C(e.promise,i)})}function C(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var o=e.then;if(e instanceof b)return t._state=3,t._value=e,void k(t);if("function"==typeof o)return void I(y(o,e),t)}t._state=1,t._value=e,k(t)}catch(e){U(t,e)}}function U(t,e){t._state=2,t._value=e,k(t)}function k(t){2===t._state&&0===t._deferreds.length&&b._immediateFn(function(){t._handled||b._unhandledRejectionFn(t._value)});for(var e=0,o=t._deferreds.length;e<o;e++)_(t,t._deferreds[e]);t._deferreds=null}function P(t,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=o}function I(t,e){var o=!1;try{t(function(t){o||(o=!0,C(e,t))},function(t){o||(o=!0,U(e,t))})}catch(t){if(o)return;o=!0,U(e,t)}}function T(t){switch(t.storageType){case"localStorage":try{return window.localStorage.setItem("testKey","test"),window.localStorage.removeItem("testKey"),new A(t.storageNamespace)}catch(t){}case"sessionStorage":try{return window.sessionStorage.setItem("testKey","test"),window.sessionStorage.removeItem("testKey"),new z(t.storageNamespace)}catch(t){}case"cookieStorage":return new E(t.cookieStorage);case"memoryStorage":default:return new q(t.storageNamespace)}}function O(t,e){if(!O.installed){O.installed=!0;var o=null;Object.defineProperties(t.prototype,{$auth:{get:function(){if(!o){if(!this.$http)throw new Error("Request handler instance not found");o=new N(this.$http,e)}return o}}})}}"function"!=typeof Object.assign&&(Object.assign=function(t,e){var o=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1;n<arguments.length;n++){var r=o[n];if(null!=r)for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])}return i});var j=setTimeout;b.prototype.catch=function(t){return this.then(null,t)},b.prototype.then=function(t,e){var o=new this.constructor(w);return _(this,new P(t,e,o)),o},b.all=function(t){var e=Array.prototype.slice.call(t);return new b(function(t,o){function i(r,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(t){i(r,t)},o)}e[r]=a,0==--n&&t(e)}catch(t){o(t)}}if(0===e.length)return t([]);for(var n=e.length,r=0;r<e.length;r++)i(r,e[r])})},b.resolve=function(t){return t&&"object"==typeof t&&t.constructor===b?t:new b(function(e){e(t)})},b.reject=function(t){return new b(function(e,o){o(t)})},b.race=function(t){return new b(function(e,o){for(var i=0,n=t.length;i<n;i++)t[i].then(e,o)})},b._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){j(t,0)},b._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},b._setImmediateFn=function(t){b._immediateFn=t},b._setUnhandledRejectionFn=function(t){b._unhandledRejectionFn=t};var S={baseUrl:null,tokenName:"token",tokenPrefix:"vueauth",tokenHeader:"Authorization",tokenType:"Bearer",loginUrl:"/auth/login",registerUrl:"/auth/register",logoutUrl:null,storageType:"localStorage",storageNamespace:"vue-authenticate",cookieStorage:{domain:window.location.hostname,path:"/",secure:!1},requestDataKey:"data",responseDataKey:"data",bindRequestInterceptor:function(t){var e=t.options.tokenHeader;t.$http.interceptors.request.use(function(o){return t.isAuthenticated()?o.headers[e]=[t.options.tokenType,t.getToken()].join(" "):delete o.headers[e],o})},bindResponseInterceptor:function(t){t.$http.interceptors.response.use(function(e){return t.setToken(e),e})},providers:{facebook:{name:"facebook",url:"/auth/facebook",authorizationEndpoint:"https://www.facebook.com/v2.11/dialog/oauth",redirectUri:window.location.origin+"/",requiredUrlParams:["display","scope"],scope:["email"],scopeDelimiter:",",display:"popup",oauthType:"2.0",popupOptions:{width:580,height:400}},google:{name:"google",url:"/auth/google",authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",redirectUri:window.location.origin,requiredUrlParams:["scope"],optionalUrlParams:["display"],scope:["profile","email"],scopePrefix:"openid",scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:452,height:633}},github:{name:"github",url:"/auth/github",authorizationEndpoint:"https://github.com/login/oauth/authorize",redirectUri:window.location.origin,optionalUrlParams:["scope"],scope:["user:email"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:1020,height:618}},instagram:{name:"instagram",url:"/auth/instagram",authorizationEndpoint:"https://api.instagram.com/oauth/authorize",redirectUri:window.location.origin,requiredUrlParams:["scope"],scope:["basic"],scopeDelimiter:"+",oauthType:"2.0",popupOptions:{width:null,height:null}},twitter:{name:"twitter",url:"/auth/twitter",authorizationEndpoint:"https://api.twitter.com/oauth/authenticate",redirectUri:window.location.origin,oauthType:"1.0",popupOptions:{width:495,height:645}},bitbucket:{name:"bitbucket",url:"/auth/bitbucket",authorizationEndpoint:"https://bitbucket.org/site/oauth2/authorize",redirectUri:window.location.origin+"/",optionalUrlParams:["scope"],scope:["email"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:1020,height:618}},linkedin:{name:"linkedin",url:"/auth/linkedin",authorizationEndpoint:"https://www.linkedin.com/oauth/v2/authorization",redirectUri:window.location.origin,requiredUrlParams:["state"],scope:["r_emailaddress"],scopeDelimiter:" ",state:"STATE",oauthType:"2.0",popupOptions:{width:527,height:582}},live:{name:"live",url:"/auth/live",authorizationEndpoint:"https://login.live.com/oauth20_authorize.srf",redirectUri:window.location.origin,requiredUrlParams:["display","scope"],scope:["wl.emails"],scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:500,height:560}},twitch:{name:"twitch",url:"/auth/twitch",authorizationEndpoint:"https://api.twitch.tv/kraken/oauth2/authorize",redirectUri:window.location.origin,requiredUrlParams:["scope"],scope:["user:read:email","user_follows_edit","user_subscriptions"],scopeDelimiter:"+",oauthType:"2.0",popupOptions:{width:500,height:560}},youtube:{name:"youtube",url:"/auth/youtube",authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",redirectUri:window.location.origin,requiredUrlParams:["scope"],optionalUrlParams:["display","access_type"],scope:["https://www.googleapis.com/auth/youtube","https://www.googleapis.com/auth/userinfo.email"],scopePrefix:"openid",scopeDelimiter:" ",accessType:"offline",display:"popup",oauthType:"2.0",popupOptions:{width:452,height:633}},streamlabs:{name:"streamlabs",url:"/auth/streamlabs",authorizationEndpoint:"https://streamlabs.com/api/v1.0/authorize",redirectUri:window.location.origin,requiredUrlParams:["scope"],scope:["donations.create","donations.read"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:1020,height:700}},streamtip:{name:"streamtip",url:"/auth/streamtip",authorizationEndpoint:"https://streamtip.com/api/oauth2/authorize",redirectUri:window.location.origin,oauthType:"2.0",popupOptions:{width:1020,height:700}},stripe:{name:"stripe",url:"/auth/stripe",authorizationEndpoint:"https://connect.stripe.com/oauth/authorize",redirectUri:window.location.origin,requiredUrlParams:["response_type","client_id","scope"],display:"popup",oauthType:"2.0",popupOptions:{width:500,height:560}},mixer:{name:"mixer",url:"/auth/mixer",authorizationEndpoint:"https://mixer.com/oauth/authorize",redirectUri:window.location.origin,display:"popup",oauthType:"2.0",popupOptions:{width:500,height:560}},oauth1:{name:null,url:"/auth/oauth1",authorizationEndpoint:null,redirectUri:window.location.origin,oauthType:"1.0",popupOptions:null},oauth2:{name:null,url:"/auth/oauth2",clientId:null,redirectUri:window.location.origin,authorizationEndpoint:null,defaultUrlParams:["response_type","client_id","redirect_uri"],requiredUrlParams:null,optionalUrlParams:null,scope:null,scopePrefix:null,scopeDelimiter:null,state:null,oauthType:"2.0",popupOptions:null,responseType:"code",responseParams:{code:"code",clientId:"clientId",redirectUri:"redirectUri"}}}},E=function(t){this._defaultOptions=c({domain:window.location.hostname,expires:null,path:"/",secure:!1,sameSite:"Lax"},t)};E.prototype.setItem=function(t,e){var o=c({},this._defaultOptions),i=v(t,e,o);this._setCookie(i)},E.prototype.getItem=function(t){var e=g(this._getCookie());return e.hasOwnProperty(t)?e[t]:null},E.prototype.removeItem=function(t){var e=c({},this._defaultOptions),o=c(e,{expires:new Date(0)}),i=v(t,"",o);this._setCookie(i)},E.prototype._getCookie=function(){return"undefined"==typeof document?"":void 0===document.cookie?"":document.cookie},E.prototype._setCookie=function(t){document.cookie=t};var A=function(t){this.namespace=t||null};A.prototype.setItem=function(t,e){window.localStorage.setItem(this._getStorageKey(t),e)},A.prototype.getItem=function(t){return window.localStorage.getItem(this._getStorageKey(t))},A.prototype.removeItem=function(t){window.localStorage.removeItem(this._getStorageKey(t))},A.prototype._getStorageKey=function(t){return this.namespace?[this.namespace,t].join("."):t};var q=function(t){this.namespace=t||null,this._storage={}};q.prototype.setItem=function(t,e){this._storage[this._getStorageKey(t)]=e},q.prototype.getItem=function(t){return this._storage[this._getStorageKey(t)]},q.prototype.removeItem=function(t){delete this._storage[this._getStorageKey(t)]},q.prototype._getStorageKey=function(t){return this.namespace?[this.namespace,t].join("."):t};var z=function(t){this.namespace=t||null};z.prototype.setItem=function(t,e){window.sessionStorage.setItem(this._getStorageKey(t),e)},z.prototype.getItem=function(t){return window.sessionStorage.getItem(this._getStorageKey(t))},z.prototype.removeItem=function(t){window.sessionStorage.removeItem(this._getStorageKey(t))},z.prototype._getStorageKey=function(t){return this.namespace?[this.namespace,t].join("."):t};var R=function(t,e,o){this.popup=null,this.url=t,this.name=e,this.popupOptions=o};R.prototype.open=function(t,e){try{return r()||a()||s()?p()&&u()&&!s()?window.open(this.url):window.location=this.url:this.popup=window.open(this.url,this.name,this._stringifyOptions()),this.popup&&this.popup.focus&&this.popup.focus(),e?Promise.resolve():this.pooling(t)}catch(t){return Promise.reject(new Error("OAuth popup error occurred"))}},R.prototype.pooling=function(t){var e=this;return new Promise(function(o,i){var n=document.createElement("a");n.href=t;var r=l(n);console.debug("[VA] redirectUriPath: %o",r);var a=setInterval(function(){console.debug("[VA] popup: %o",e.popup),e.popup&&!e.popup.closed&&void 0!==e.popup.closed||(clearInterval(a),a=null,i(new Error("Auth popup window closed")));try{var t=l(e.popup.location);if(console.debug("[VA] popupWindowPath: %o",t),t===r){if(console.debug("[VA] popup path and redirect path are the same"),e.popup.location.search||e.popup.location.hash){var n=d(e.popup.location.search.substring(1).replace(/\/$/,"")),s=d(e.popup.location.hash.substring(1).replace(/[\/$]/,"")),p=c({},n);p=c(p,s),p.error?i(new Error(p.error)):o(p)}else i(new Error("OAuth redirect has occurred but no query or hash parameters were found."));clearInterval(a),a=null,console.debug("[VA] popup closing"),e.popup.close()}else console.debug("[VA] poll loop else")}catch(t){console.debug("[VA] poll catch")}},250)})},R.prototype._stringifyOptions=function(){var t=this,o=[];for(var i in t.popupOptions)e(t.popupOptions[i])||o.push(i+"="+t.popupOptions[i]);return o.join(",")};var D={name:null,url:null,authorizationEndpoint:null,scope:null,scopePrefix:null,scopeDelimiter:null,redirectUri:null,requiredUrlParams:null,defaultUrlParams:null,oauthType:"1.0",popupOptions:{}},K=function(t,e,o,i){this.$http=t,this.storage=e,this.providerConfig=c({},D),this.providerConfig=c(this.providerConfig,o),this.options=i};K.prototype.init=function(t){var e=this;return r()||a()||s()?this.oauthPopup=new R("/oauth/twitter",this.providerConfig.name,this.providerConfig.popupOptions):this.oauthPopup=new R("about:blank",this.providerConfig.name,this.providerConfig.popupOptions),window&&!window.cordova&&this.oauthPopup.open(this.providerConfig.redirectUri,!0),this.getRequestToken().then(function(o){return e.openPopup(o).then(function(o){return e.exchangeForToken(o,t)})})},K.prototype.getRequestToken=function(){var t={};return t.method="POST",t[this.options.requestDataKey]=c({},this.providerConfig),t.withCredentials=this.options.withCredentials,this.options.baseUrl?t.url=h(this.options.baseUrl,this.providerConfig.url):t.url=this.providerConfig.url,this.$http(t)},K.prototype.openPopup=function(t){var e=[this.providerConfig.authorizationEndpoint,this.buildQueryString(t[this.options.responseDataKey])].join("?");return this.oauthPopup.popup.location=e,window&&window.cordova?this.oauthPopup.open(this.providerConfig.redirectUri):this.oauthPopup.pooling(this.providerConfig.redirectUri)},K.prototype.exchangeForToken=function(t,e){if(t.denied)return Promise.reject(new Error("denied"));var o=c({},e);o=c(o,t);var i={};return i.method="POST",i[this.options.requestDataKey]=o,i.withCredentials=this.options.withCredentials,this.options.baseUrl?i.url=h(this.options.baseUrl,this.providerConfig.url):i.url=this.providerConfig.url,this.$http(i)},K.prototype.buildQueryString=function(t){var e=[];for(var o in t){var i=t[o];e.push(encodeURIComponent(o)+"="+encodeURIComponent(i))}return e.join("&")};var x={name:null,url:null,clientId:null,authorizationEndpoint:null,redirectUri:null,scope:null,scopePrefix:null,scopeDelimiter:null,state:null,requiredUrlParams:null,defaultUrlParams:["response_type","client_id","redirect_uri"],responseType:"code",responseParams:{code:"code",clientId:"clientId",redirectUri:"redirectUri"},oauthType:"2.0",popupOptions:{}},$=function(t,e,o,i){this.$http=t,this.storage=e,this.providerConfig=c({},x),this.providerConfig=c(this.providerConfig,o),this.options=i};$.prototype.init=function(t){var e=this,o=this.providerConfig.name+"_state";n(this.providerConfig.state)?this.storage.setItem(o,this.providerConfig.state()):i(this.providerConfig.state)&&this.storage.setItem(o,this.providerConfig.state);var r=[this.providerConfig.authorizationEndpoint,this._stringifyRequestParams()].join("?");return this.oauthPopup=new R(r,this.providerConfig.name,this.providerConfig.popupOptions),new Promise(function(i,n){e.oauthPopup.open(e.providerConfig.redirectUri).then(function(r){return"token"!==e.providerConfig.responseType&&e.providerConfig.url?r.state&&r.state!==e.storage.getItem(o)?n(new Error("State parameter value does not match original OAuth request state value")):void i(e.exchangeForToken(r,t)):i(r)}).catch(function(t){n(t)})})},$.prototype.exchangeForToken=function(t,e){var o=this,i=c({},e);for(var n in x.responseParams){switch(n){case"code":i[n]=t.code;break;case"clientId":i[n]=o.providerConfig.clientId;break;case"redirectUri":i[n]=o.providerConfig.redirectUri;break;default:i[n]=t[n]}}t.state&&(i.state=t.state);var r;return r=this.options.baseUrl?h(this.options.baseUrl,this.providerConfig.url):this.providerConfig.url,this.$http.post(r,i,{withCredentials:this.options.withCredentials})},$.prototype._stringifyRequestParams=function(){var e=this,o=[];return["defaultUrlParams","requiredUrlParams","optionalUrlParams"].forEach(function(i){e.providerConfig[i]&&Array.isArray(e.providerConfig[i])&&e.providerConfig[i].forEach(function(i){var r=t(i),a=n(e.providerConfig[i])?e.providerConfig[i]():e.providerConfig[r];if("redirect_uri"!==i||a){if("state"===i){var s=e.providerConfig.name+"_state";a=encodeURIComponent(e.storage.getItem(s))}"scope"===i&&Array.isArray(a)&&(a=a.join(e.providerConfig.scopeDelimiter),e.providerConfig.scopePrefix&&(a=[e.providerConfig.scopePrefix,a].join(e.providerConfig.scopeDelimiter))),o.push([i,a])}})}),o.map(function(t){return t.join("=")}).join("&")};var N=function(t,e){var o=c({},S);o=c(o,e);var i=T(o);if(Object.defineProperties(this,{$http:{get:function(){return t}},options:{get:function(){return o}},storage:{get:function(){return i}},tokenName:{get:function(){return this.options.tokenPrefix?[this.options.tokenPrefix,this.options.tokenName].join("_"):this.options.tokenName}}}),!(this.options.bindRequestInterceptor&&n(this.options.bindRequestInterceptor)&&this.options.bindResponseInterceptor&&n(this.options.bindResponseInterceptor)))throw new Error("Both request and response interceptors must be functions");this.options.bindRequestInterceptor.call(this,this),this.options.bindResponseInterceptor.call(this,this)};return N.prototype.isAuthenticated=function(){var t=this.storage.getItem(this.tokenName);if(t){if(3===t.split(".").length)try{var e=t.split(".")[1],o=e.replace("-","+").replace("_","/"),i=JSON.parse(window.atob(o)).exp;if("number"==typeof i)return Math.round((new Date).getTime()/1e3)<i}catch(t){return!0}return!0}return!1},N.prototype.getToken=function(){return this.storage.getItem(this.tokenName)},N.prototype.setToken=function(t){t[this.options.responseDataKey]&&(t=t[this.options.responseDataKey]);var e;t.access_token&&(o(t.access_token)&&o(t.access_token[this.options.responseDataKey])?t=t.access_token:i(t.access_token)&&(e=t.access_token)),!e&&t&&(e=t[this.options.tokenName]),e&&this.storage.setItem(this.tokenName,e)},N.prototype.getPayload=function(){var t=this.storage.getItem(this.tokenName);if(t&&3===t.split(".").length)try{var e=t.split(".")[1],o=e.replace("-","+").replace("_","/");return JSON.parse(f(o))}catch(t){}},N.prototype.login=function(t,e){var o=this;return e=e||{},e.url=e.url?e.url:h(this.options.baseUrl,this.options.loginUrl),e[this.options.requestDataKey]=t||e[this.options.requestDataKey],e.method=e.method||"POST",e.withCredentials=e.withCredentials||this.options.withCredentials,this.$http(e).then(function(t){return o.setToken(t),t})},N.prototype.register=function(t,e){var o=this;return e=e||{},e.url=e.url?e.url:h(this.options.baseUrl,this.options.registerUrl),e[this.options.requestDataKey]=t||e[this.options.requestDataKey],e.method=e.method||"POST",e.withCredentials=e.withCredentials||this.options.withCredentials,this.$http(e).then(function(t){return o.setToken(t),t})},N.prototype.logout=function(t){var e=this;return this.isAuthenticated()?(t=t||{},t.url?(t.url=t.url?t.url:h(this.options.baseUrl,this.options.logoutUrl),t.method=t.method||"POST",t[this.options.requestDataKey]=t[this.options.requestDataKey]||void 0,t.withCredentials=t.withCredentials||this.options.withCredentials,this.$http(t).then(function(t){e.storage.removeItem(e.tokenName)})):(this.storage.removeItem(this.tokenName),b.resolve())):b.reject(new Error("There is no currently authenticated user"))},N.prototype.authenticate=function(t,e,o){var i=this;return new b(function(o,n){var r=i.options.providers[t];if(!r)return n(new Error("Unknown provider"));var a;switch(r.oauthType){case"1.0":a=new K(i.$http,i.storage,r,i.options);break;case"2.0":a=new $(i.$http,i.storage,r,i.options);break;default:return n(new Error("Invalid OAuth type"))}return a.init(e).then(function(t){return i.setToken(t),i.isAuthenticated()?o(t):n(t)}).catch(function(t){return n(t)})})},O.factory=function(t,e){return new N(t,e)},O});